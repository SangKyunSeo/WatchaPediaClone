import{u as g,b as _,j as m,_ as w,d as p,o as r,c as a,a as e,t as l,k as c,h as v,i as b,v as f,F as D,e as y,f as B,w as I,p as k,g as A}from"./index-236afee1.js";const V={name:"MovieDetail",props:{movie_num:{type:Number,default:0}},data(){return{movieDetails:{movie_num:0,movie_name:"",movie_open:"",movie_content:"",movie_grade:0,image_url:"",image_oname:""},movieGenreName:"",movieCastList:[{person_item_num:0,person_num:0,item_type:0,item_num:0,person_item_role:"",person_name:"",image_url:"",image_oname:""}],scrabInfo:{scrab_num:0,member_num:0,scrab_item_type:0,scrab_item_num:0,scrab_type:-1},reviewInfo:{review_num:0,member_num:0,review_item_type:0,review_item_num:0,review_content:"",review_score:0,review_regdate:"",review_scrab_type:0},wishWatchValue:-1,watchingValue:-1,router:g(),loginState:this.$store.getters.getLoginState,member_num:this.$store.getters.getUserNum,modalActive:!1}},mounted(){this.getMovieDetail(),this.getMovieGenre(),this.getMovieCast(),this.loginState==!0&&this.getScrabInfo()},computed:{},methods:{getMovieDetail(){_.get("/getMovieInfo",{params:{movie_num:this.$route.params.movie_num}}).then(s=>{this.movieDetails=s.data,this.movieDetails.movie_open=this.movieDetails.movie_open.substring(0,4)})},getMovieGenre(){_.get("/getMovieGenre",{params:{movie_num:this.$route.params.movie_num}}).then(s=>{this.movieGenreName=s.data})},getMovieCast(){_.get("/getMovieCast",{params:{movie_num:this.$route.params.movie_num}}).then(s=>{this.movieCastList=s.data})},getImageUrl(s){const t=window.location.href;return new URL(`../movieimg/${s}.jpg`,t).href},getProfileImageUrl(s){const t=window.location.href;return new URL(`../personimg/${s}.jpg`,t).href},async getScrabInfo(){try{const s=await m.get("/getScrabInfo",{params:{movie_num:this.$route.params.movie_num,member_num:this.member_num,scrab_item_type:1}});console.log("Response: "+s),this.scrabInfo=s.data,this.scrabInfo.scrab_type==0?this.watchingValue=1:this.scrabInfo.scrab_type==1&&(this.wishWatchValue=1)}catch(s){console.log("Error: "+s)}},async wishWatch(){if(this.$store.getters.getAccessToken=="")alert("로그인이 필요합니다.");else try{const t=await m.get("/setWishWatch",{params:{member_num:this.member_num,scrab_item_type:1,scrab_item_num:this.$route.params.movie_num,scrab_type:1}});console.log("Response: "+t),this.scrabInfo=t.data,this.scrabInfo.scrab_type==1&&this.scrabInfo.member_num!=0&&(this.wishWatchValue=1,this.watchingValue=-1),this.scrabInfo||(this.wishWatchValue=-1)}catch(t){console.log("Error: "+t)}},writeComment(){this.$store.getters.getAccessToken==""?alert("로그인이 필요합니다."):this.modalActive=!0},async setReview(){if(this.reviewInfo.review_content=="")alert("코멘트를 작성하세요!");else{this.modalActive=!0;try{const s=await m.post("/setReview",{params:{member_num:this.member_num,scrab_type:this.scrabInfo.scrab_type,review_item_type:1,review_item_num:this.$route.params.movie_num,review_score:this.reviewInfo.review_score,review_content:this.reviewInfo.review_content}});console.log("Response: "+s),this.reviewInfo=s.data}catch(s){console.log("Error : "+s)}}},async watching(){if(this.$store.getters.getAccessToken=="")alert("로그인이 필요합니다.");else try{const t=await m.get("/setWishWatch",{params:{member_num:this.member_num,scrab_item_type:1,scrab_item_num:this.$route.params.movie_num,scrab_type:0}});console.log("Response: "+t),this.scrabInfo=t.data,this.scrabInfo.scrab_type==0&&this.scrabInfo.member_num!=0&&(this.wishWatchValue=-1,this.watchingValue=1),this.scrabInfo||(this.watchingValue=-1)}catch(t){console.log("Error: "+t)}},async getReview(){try{const s=await m.get("/getReviewInfo",{params:{member_num:this.member_num,review_item_type:1,review_item_num:this.$route.params.movie_num}});this.reviewInfo=s.data}catch(s){console.log("Error : "+s)}},cancleComment(){this.modalActive=!1},textChange(){this.$refs.textTarget.style.height="auto",this.$refs.textTarget.style.height=this.$refs.textTarget.scrollHeight+"px"}}};const n=s=>(k("data-v-31370746"),s=s(),A(),s),F=n(()=>e("h1",null,"영화 상세 화면",-1)),x={class:"movie-detail-header"},T={class:"movie-post"},W={class:"movie-post-summary"},R={key:0},E={key:1},M={key:2},U={class:"movie-summary"},N={class:"movie-info"},S={class:"movie-image"},L={class:"movie-image-child1"},G={class:"movie-image-child2"},j=["src"],P={class:"movie-detail-info"},H={class:"section-review"},q=n(()=>e("div",{class:"movie-review"},[e("div",{class:"review-star"},[e("div",null," 별그림 ")]),e("div",{class:"review-btn"},[e("div",null,"평가하기")])],-1)),z={class:"review-buttons"},J=n(()=>e("div",{class:"wish-btn"},"+",-1)),K=n(()=>e("div",{class:"wish-btn"},"+",-1)),O=n(()=>e("div",{class:"comment-btn"},"연필",-1)),Q=n(()=>e("div",{class:"watching-btn"},"눈",-1)),X=n(()=>e("div",{class:"watching-btn"},"눈",-1)),Y={key:0},Z={key:1},$=n(()=>e("div",null," 내가 쓴 코멘트 ",-1)),ee=n(()=>e("div",null,"프로필 사진",-1)),te=n(()=>e("ul",null,[e("li",null,[e("button",null,"삭제")]),e("li",null,[e("button",null,"수정")])],-1)),se={class:"section-movie-detail-info"},ie={key:0,class:"modal-main"},oe={class:"modal-container"},ne={class:"modal-content"},re={class:"modal-write-area"},ae={class:"modal-button-area"},ue={class:"modal-button-content"},le=n(()=>e("p",null,"0/4000",-1)),me={class:"movie-person-comment"},ce={class:"movie-persons"},_e={class:"person-title"},ve=n(()=>e("h2",null,"출연/제작",-1)),he={class:"person-profile-image"},de=["src"],Ce={class:"person-name"},ge={class:"person-role"},we=n(()=>e("div",{class:"person-main"},null,-1)),pe=n(()=>e("section",{class:"movie-comments"},[e("div",{class:"comment-title"},[e("h2",null,"코멘트")]),e("div",{class:"comment-main"})],-1));function be(s,t,h,fe,i,u){const d=p("router-link");return r(),a("main",null,[F,e("div",x,[e("div",T,[e("div",W,[e("div",null,[e("h1",null,l(i.movieDetails.movie_name),1),e("div",null,l(i.movieDetails.movie_name),1),e("div",null,l(i.movieDetails.movie_open)+" • "+l(i.movieGenreName),1),i.movieDetails.movie_grade==0?(r(),a("div",R,"2시간4분 / 전체")):i.movieDetails.movie_grade==18?(r(),a("div",E,"2시간4분 / 청불")):(r(),a("div",M,"2시간4분 / "+l(i.movieDetails.movie_grade)+"세",1))])])]),e("div",U,[e("section",N,[e("div",S,[e("div",L,[e("div",G,[e("img",{src:u.getImageUrl(`${i.movieDetails.image_oname}`)},null,8,j)])])]),e("div",P,[e("section",H,[q,e("div",z,[i.wishWatchValue==-1?(r(),a("button",{key:0,class:"wish-watch",onClick:t[0]||(t[0]=o=>u.wishWatch())},[J,c(" 보고싶어요 ")])):(r(),a("button",{key:1,class:"wish-watch",onClick:t[1]||(t[1]=o=>u.wishWatch()),style:{"border-color":"pink"}},[K,c(" 보고싶어요 ")])),e("button",{class:"write-comment",onClick:t[2]||(t[2]=o=>u.writeComment())},[O,c(" 코멘트 ")]),i.watchingValue==-1?(r(),a("button",{key:2,class:"watching",onClick:t[3]||(t[3]=o=>u.watching())},[Q,c(" 보는중 ")])):(r(),a("button",{key:3,class:"watching",onClick:t[4]||(t[4]=o=>u.watching()),style:{"border-color":"pink"}},[X,c(" 보는중 ")]))])]),(i.watchingValue!=-1||i.wishWatchValue!=-1)&&i.reviewInfo.review_content==""?(r(),a("section",Y,[e("div",null,[e("section",null,[e("div",null,[e("div",null,[e("div",null,[e("h3",null,l(s.$store.getters.getUserName)+" 님의 생각을 글로 적어보세요.",1),e("div",null,[e("button",{onClick:t[5]||(t[5]=o=>u.writeComment())},"코멘트 남기기")])])])])])])])):v("",!0),(i.watchingValue!=-1||i.wishWatchValue!=-1)&&i.reviewInfo.review_content!=""?(r(),a("section",Z,[$,e("div",null,[e("div",null,[e("div",null,[e("section",null,[e("div",null,[ee,e("a",null,[e("div",null,[e("div",null,[e("div",null,l(i.reviewInfo.review_content),1)])])]),te])])])])])])):v("",!0),e("section",se,l(i.movieDetails.movie_content),1)])])])]),i.modalActive==!0?(r(),a("div",ie,[e("div",oe,[e("div",ne,[e("header",null,[e("em",null,l(i.movieDetails.movie_name),1),e("div",null,[e("button",{onClick:t[6]||(t[6]=o=>u.cancleComment())},"취소")])]),e("div",re,[b(e("textarea",{class:"modal-write-content",rows:"{1}",maxlength:"4000",placeholder:"이 작품에 대한 생각을 자유롭게 표현해주세요.",onInput:t[7]||(t[7]=o=>u.textChange()),ref:"textTarget","onUpdate:modelValue":t[8]||(t[8]=o=>i.reviewInfo.review_content=o)},null,544),[[f,i.reviewInfo.review_content]])]),e("div",ae,[e("div",ue,[le,e("button",{onClick:t[9]||(t[9]=o=>u.setReview())},"저장")])])])])])):v("",!0),e("div",me,[e("section",ce,[e("div",_e,[ve,e("ul",null,[(r(!0),a(D,null,y(i.movieCastList,(o,C)=>(r(),a("li",{key:C},[B(d,{to:{name:"PersonDetail",params:{person_num:o.person_num}},class:"movieCast-details"},{default:I(()=>[e("div",he,[e("img",{src:u.getProfileImageUrl(`${o.image_oname}`)},null,8,de)]),e("div",null,[e("div",null,[e("div",Ce,l(o.person_name),1),e("div",ge,l(o.person_item_role),1)])])]),_:2},1032,["to"])]))),128))])]),we]),pe])])}const ye=w(V,[["render",be],["__scopeId","data-v-31370746"]]);export{ye as default};
